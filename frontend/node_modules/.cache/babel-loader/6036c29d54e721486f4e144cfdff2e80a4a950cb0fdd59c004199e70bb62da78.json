{"ast":null,"code":"import React,{createContext,useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const getDefaultCart=()=>{let cart={};for(let index=0;index<300+1;index++){cart[index]=0;}return cart;};const ShopContextProvider=props=>{const[all_products,setAll_Product]=useState([]);const[cartItems,setCartItems]=useState(getDefaultCart());useEffect(()=>{fetch('http://localhost:4000/allproducts').then(response=>response.json()).then(data=>{setAll_Product(data);});if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/getcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:\"\"}).then(response=>response.json()).then(data=>setCartItems(data)).catch(error=>console.error('Error fetching cart data:',error));}},[]);const addToCart=itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]+1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/addtocart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const removeFromCart=itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]-1}));if(localStorage.getItem('auth-token')){fetch('http://localhost:4000/removefromcart',{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const emptyCart=async()=>{setCartItems(getDefaultCart());try{const response=await fetch('http://localhost:4000/emptycart',{method:'POST',headers:{'Content-Type':'application/json','auth-token':\"\".concat(localStorage.getItem('auth-token'))}});const data=await response.json();if(response.ok){console.log('Cart emptied successfully');}else{console.error('Error emptying cart:',data.errors);}}catch(error){console.error('Error emptying cart:',error);}};const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){const itemId=Number(item);let itemInfo=all_products.find(product=>product.id===itemId);console.log('item:',itemId,'itemInfo:',itemInfo);if(itemInfo&&itemInfo.new_price){totalAmount+=itemInfo.new_price*cartItems[item];}}}console.log('totalAmount:',totalAmount);return totalAmount;};const getTotalCartItems=()=>{let totalItem=0;for(const item in cartItems){if(cartItems[item]>0){totalItem+=cartItems[item];}}return totalItem;};const contextValue={getTotalCartItems,emptyCart,getTotalCartAmount,all_products,cartItems,addToCart,removeFromCart};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;//all products data can be accessed from here to be used in different components","map":{"version":3,"names":["React","createContext","useEffect","useState","jsx","_jsx","ShopContext","getDefaultCart","cart","index","ShopContextProvider","props","all_products","setAll_Product","cartItems","setCartItems","fetch","then","response","json","data","localStorage","getItem","method","headers","Accept","concat","body","catch","error","console","addToCart","itemId","prev","JSON","stringify","log","removeFromCart","emptyCart","ok","errors","getTotalCartAmount","totalAmount","item","Number","itemInfo","find","product","id","new_price","getTotalCartItems","totalItem","contextValue","Provider","value","children"],"sources":["C:/Users/ABHISHEK TRIVEDI/Desktop/program codes/east_west_aid-master/frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\n\nexport const ShopContext = createContext(null);\n\nconst getDefaultCart = ()=>{\n    let cart = {};\n    for(let index = 0; index<300+1 ; index++) {\n        cart[index] = 0;\n    }\n    return cart;\n}\n\nconst ShopContextProvider = (props)=>{\n\n    const [all_products, setAll_Product] = useState([]);\n    const [cartItems,setCartItems] = useState(getDefaultCart());\n    \n    useEffect(() => {\n        fetch('http://localhost:4000/allproducts')\n            .then((response) => response.json())\n            .then((data) => {\n                setAll_Product(data);\n            });\n    \n        if (localStorage.getItem('auth-token')) {\n            fetch('http://localhost:4000/getcart', {\n                method: 'POST',\n                headers: {\n                    Accept: 'application/form-data',\n                    'auth-token': `${localStorage.getItem('auth-token')}`,\n                    'Content-Type': 'application/json'\n                },\n                body: \"\",\n            })\n            .then((response) => response.json())\n            .then((data) => setCartItems(data))\n            .catch((error) => console.error('Error fetching cart data:', error));\n        }\n    }, []);    \n\n    const addToCart = (itemId) => {\n        setCartItems((prev)=>({...prev, [itemId]:prev[itemId]+1}))\n        if(localStorage.getItem('auth-token')) {\n            fetch('http://localhost:4000/addtocart', {\n                method: 'POST',\n                headers: {\n                    Accept: 'application/form-data',\n                    'auth-token': `${localStorage.getItem('auth-token')}`,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\"itemId\" : itemId})\n            })\n            .then((response)=>response.json())\n            .then((data)=>console.log(data));\n        }\n    }    \n\n    const removeFromCart = (itemId) => {\n        setCartItems((prev)=>({...prev, [itemId]:prev[itemId]-1}));\n        if(localStorage.getItem('auth-token')) {\n            fetch('http://localhost:4000/removefromcart', {\n                method: 'POST',\n                headers: {\n                    Accept: 'application/form-data',\n                    'auth-token': `${localStorage.getItem('auth-token')}`,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\"itemId\" : itemId})\n            })\n            .then((response)=>response.json())\n            .then((data)=>console.log(data));\n        }\n    }\n\n    const emptyCart = async () => {\n        setCartItems(getDefaultCart());\n        try {\n            const response = await fetch('http://localhost:4000/emptycart', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'auth-token': `${localStorage.getItem('auth-token')}`,\n                },\n            });\n    \n            const data = await response.json();\n    \n            if (response.ok) {\n                console.log('Cart emptied successfully');\n            } else {\n                console.error('Error emptying cart:', data.errors);\n            }\n        } catch (error) {\n            console.error('Error emptying cart:', error);\n        }\n    };    \n\n    const getTotalCartAmount = () => {\n        let totalAmount = 0;\n        for (const item in cartItems) {\n          if (cartItems[item] > 0) {\n            const itemId = Number(item);\n            let itemInfo = all_products.find((product) => product.id === itemId);\n            console.log('item:', itemId, 'itemInfo:', itemInfo);\n            if (itemInfo && itemInfo.new_price) {\n              totalAmount += itemInfo.new_price * cartItems[item];\n            }\n          }\n        }\n        console.log('totalAmount:', totalAmount);\n        return totalAmount;\n      }\n      \n    \n\n    const getTotalCartItems = () => {\n        let totalItem = 0;\n\n        for(const item in cartItems) {\n            if(cartItems[item]>0) {\n                totalItem += cartItems[item];\n            }\n        }\n\n        return totalItem;\n    }\n\n    const contextValue = {getTotalCartItems, emptyCart, getTotalCartAmount, all_products, cartItems, addToCart, removeFromCart};\n\n    return (\n        <ShopContext.Provider value={contextValue}>\n            {props.children}\n        </ShopContext.Provider>\n    )\n}\n\nexport default ShopContextProvider;\n\n//all products data can be accessed from here to be used in different components"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}